<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
  <!-- Unique identifier of the plugin. It should be FQN. It cannot be changed between the plugin versions. -->
  <id>org.pehrs.vespa-yql-plugin</id>

  <!-- Public plugin name should be written in Title Case.
       Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-name -->
  <name>Vespa-yql</name>

  <!-- Should work since 2023.1+ -->
  <!-- 2023.1.6: 231.9414.13 -->
  <idea-version since-build="231"/>

  <!-- The EDQL plugin overrides ctrl-ENTER on ALL Editors!!! -->
  <incompatible-with>com.github.chengpohi</incompatible-with>

  <!-- A displayed Vendor name or Organization ID displayed on the Plugins Page. -->
  <vendor url="https://www.pehrs.com">pehrs.com</vendor>


  <!-- Description of the plugin displayed on the Plugin Page and IDE Plugin Manager.
       Simple HTML elements (text formatting, paragraphs, and lists) can be added inside of <![CDATA[ ]]> tag.
       Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-description -->
  <description><![CDATA[
  <p>
    This plugin adds support for Vespa AI YQL requests.
    <ul>
      <li>Run YQL requests against your vespa clusters and present the result in a table.</li>
      <li>Simple highlighting of the request and the yql query value.</li>
      <li>Simple completion support is given for request snippets and the YQL query string.</li>
      <li>Render a tree view of any trace in the YQL response.</li>
    </ul>
    For more information see the <a href="https://github.com/pehrs/vespa-yql-plugin">project site</a>.
    </p>
  ]]></description>

  <change-notes><![CDATA[
<h2>New Features</h2>
<ul>
  <li>[1.0.1] - Fix since-build for idea-version</li>
  <li>[1.0.0] - First version</li>
</ul>
]]></change-notes>

  <!-- Product and plugin compatibility requirements.
       Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
  <depends>com.intellij.modules.platform</depends>

  <actions>
    <!-- FIXME: This action is not needed as we use the lang.formatter below -->
    <!--
    <action
      id="YqlJacksonReformatAction"
      class="com.pehrs.vespa.yql.plugin.actions.YqlJacksonReformatAction"
      text="Reformat Code"
      description="Reformat YQL Request"
    >
      <add-to-group group-id="ProjectViewPopupMenuModifyGroup" anchor="after" relative-to-action="ReformatCode"/>
      <add-to-group group-id="CodeFormatGroup" anchor="after" relative-to-action="ReformatCode"/>
    </action>
    -->

    <group
      id="com.pehrs.vespa.yql.plugin.actions.YqlGroup"
      text="YQL"
      popup="true"
      icon="com.pehrs.vespa.yql.plugin.YqlIcons.FILE">
      <add-to-group
        group-id="ToolsMenu"
        anchor="last"/>

      <action
        id="ExecuteQueryAction"
        class="com.pehrs.vespa.yql.plugin.actions.ExecuteQueryAction"
        text="Execute YQL Request"
        description="Execute YQL Request in current Vespa Cluster"
        icon="com.pehrs.vespa.yql.plugin.YqlIcons.FILE"
      >
        <keyboard-shortcut
          keymap="$default"
          first-keystroke="control ENTER"/>
        <!--
        <add-to-group group-id="com.pehrs.vespa.yql.plugin.actions.YqlGroup" anchor="first"/>
        <add-to-group group-id="EditorPopupMenu" anchor="first"/>
        <add-to-group group-id="RunMenu" anchor="first"/>
        -->
      </action>
    </group>



  </actions>

  <!-- Extension points defined by the plugin.
       Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
  <extensions defaultExtensionNs="com.intellij">
    <actionPromoter implementation="com.pehrs.vespa.yql.plugin.actions.YqlActionPromoter"/>

    <applicationService
      serviceImplementation="com.pehrs.vespa.yql.plugin.settings.YqlAppSettingsState"/>
    <applicationConfigurable
      parentId="tools"
      instance="com.pehrs.vespa.yql.plugin.settings.YqlAppSettingsConfigurable"
      id="com.pehrs.vespa.yql.plugin.settings.YqlAppSettingsConfigurable"
      displayName="Vespa YQL"/>

    <notificationGroup
      id="Vespa YQL"
      displayType="BALLOON"/>

    <toolWindow id="Vespa"
      secondary="false"
      anchor="right"
      icon="com.pehrs.vespa.yql.plugin.YqlIcons.FILE"
      factoryClass="com.pehrs.vespa.yql.plugin.dock.YqlDockFactory" />
    <toolWindow id="Vespa YQL Results"
      secondary="false"
      anchor="bottom"
      icon="com.pehrs.vespa.yql.plugin.YqlIcons.FILE"
      factoryClass="com.pehrs.vespa.yql.plugin.results.YqlResultsFactory"/>

    <fileType
      name="YQL"
      implementationClass="com.pehrs.vespa.yql.plugin.YqlFileType"
      fieldName="INSTANCE"
      language="YQL"
      extensions="yql"/>
    <lang.parserDefinition
      language="YQL"
      implementationClass="com.pehrs.vespa.yql.plugin.YqlParserDefinition"/>
    <annotator
      language="YQL"
      implementationClass="com.pehrs.vespa.yql.plugin.annotator.YqlAnnotator"/>
    <lang.syntaxHighlighterFactory
      language="YQL"
      implementationClass="com.pehrs.vespa.yql.plugin.highlighting.YqlSyntaxHighlighterFactory"/>
    <highlightVisitor implementation="com.pehrs.vespa.yql.plugin.highlighting.YqlRainbowVisitor"/>
    <colorSettingsPage implementation="com.pehrs.vespa.yql.plugin.highlighting.YqlColorsPage"/>
    <completion.contributor
      language="YQL"
      implementationClass="com.pehrs.vespa.yql.plugin.completions.YqlCompletionContributor"/>

    <lang.formatter language="YQL" implementationClass="com.pehrs.vespa.yql.plugin.formatter.YqlFormattingBuilderModel"/>

  </extensions>
</idea-plugin>